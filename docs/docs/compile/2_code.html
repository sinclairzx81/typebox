<h1>Code</h1>
<p>The Code function is used to create standalone Esm validation modules that can be written to disk and imported as regular JavaScript modules. This function is an alternative to Compile and provides a way to achieve high throughput validation in <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP">Content Security Policy</a> restricted environments.</p>
<h2>CodeResult</h2>
<p>The Code function returns a CodeResult structure that contains two properties, Code and External.</p>
<pre><code class="language-typescript">import { Code } from &#39;typebox/compile&#39;

const result = Code(Type.String())

console.log(result.Code)                           // export function SetExternal(external) { ... }
                                                   // 
                                                   // export function Check(value) { ... }

console.log(result.External)                       // { identifier: &#39;...&#39;, variables: [...] }
</code></pre>
<h2>Code</h2>
<p>The Code property is plain JavaScript that can be written to disk.</p>
<h2>External</h2>
<p>The External property is variables that cannot be serialized to JavaScript code. The External property is needed to support non-schema data structures, such as implementations of Standard Schema. The TypeBox compiler will detect these instances and return them as external variables that need to be explicitly injected into the module via the <code>SetExternal</code> function. </p>
<pre><code class="language-typescript">import { Code } from &#39;typebox/compile&#39;

// ------------------------------------------------------------------
// Create Type
// ------------------------------------------------------------------

import * as z from &#39;npm:zod&#39;

const T = Type.Object({
  x: z.number(),
  y: z.number()
})

// ------------------------------------------------------------------
// Generate Module
// ------------------------------------------------------------------

const esm = Code(T)

// ------------------------------------------------------------------
// Inspect Internal
// ------------------------------------------------------------------

console.log(esm.External)                           // {
                                                    //   variables: [
                                                    //      ZodNumber,
                                                    //      ZodNumber
                                                    //   ]
                                                    // }

// ------------------------------------------------------------------
// Write Module
// ------------------------------------------------------------------

Deno.writeTextFileSync(&#39;./t.ts&#39;, esm.Code)

// ------------------------------------------------------------------
// Import Module
// ------------------------------------------------------------------

import { Check, SetExternal } from &#39;./t.ts&#39;

// ------------------------------------------------------------------
// Set External
// ------------------------------------------------------------------

SetExternal(esm.External)

// ------------------------------------------------------------------
// Check
// ------------------------------------------------------------------

const R = Check({ x: 1, y: 1 })                    // const R: boolean = true
</code></pre>
