import Type, { type Static } from 'typebox'
import Compile from 'typebox/compile'
import Format from 'typebox/format'
import Value from 'typebox/value'

// ------------------------------------------------------------------
// Type
// ------------------------------------------------------------------
const T = Type.Object({
  x: Type.Number(),
  y: Type.Number(),
  z: Type.Number()
})

// ------------------------------------------------------------------
// Script
// ------------------------------------------------------------------
const S = Type.Script({ T }, `{
  [K in keyof T]: T[K] | null
}`)

// ------------------------------------------------------------------
// Infer
// ------------------------------------------------------------------
type T = Static<typeof T>
type S = Static<typeof S>

// ------------------------------------------------------------------
// Parse
// ------------------------------------------------------------------

const R = Value.Parse(T, { x: 1, y: 2, z: 3 })

// ------------------------------------------------------------------
// Compile
// ------------------------------------------------------------------

const C = Compile.Compile(S)

const X = C.Parse(C)

// ------------------------------------------------------------------
// Format
// ------------------------------------------------------------------

const E = Format.IsEmail('user@domain.com')